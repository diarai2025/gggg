# Настройка кошелька

## Проблема: "Не удалось загрузить кошелек"

Если вы видите ошибку "Не удалось загрузить кошелек", выполните следующие шаги:

### 1. Обновите Prisma Client

После добавления модели Wallet в schema, нужно обновить Prisma Client:

```bash
cd server
npm run prisma:generate
```

### 2. Перезапустите сервер

После обновления Prisma Client перезапустите сервер:

```bash
cd server
npm run dev
```

### 3. Проверьте подключение к базе данных

Убедитесь, что:
- В файле `server/.env` указан правильный `DATABASE_URL`
- База данных доступна
- Миграция применена (таблица `wallets` существует)

### 4. Проверьте логи сервера

При загрузке кошелька в консоли сервера должны появиться логи:
- `[getWallet] Запрос на получение кошелька для пользователя: ...`
- `[getWallet] Пользователь найден, ID: ...`
- `[getWallet] Кошелек найден/создан`

Если видите ошибку `Unknown model 'Wallet'`, значит Prisma Client не обновлен.

## API Endpoints

- `GET /api/wallet` - получить кошелек пользователя
- `POST /api/wallet/add` - пополнить кошелек
- `POST /api/wallet/withdraw` - снять средства
- `PUT /api/wallet/currency` - обновить валюту

## Структура кошелька

- `id` - ID кошелька
- `userId` - ID пользователя (уникальный)
- `balance` - баланс (Decimal)
- `currency` - валюта (по умолчанию "₸")
- `createdAt` - дата создания
- `updatedAt` - дата обновления

Кошелек автоматически создается при первом обращении, если его еще нет.


